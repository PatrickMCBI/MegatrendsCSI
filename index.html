<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MCSI</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
      }
      .form-group {
        margin: 20px;
      }
      .form-group input,
      select {
        width: 250px;
        height: 30px;
        outline: none;
        font-size: 15px;
        padding: 0 5px;
      }
      .form-group textarea {
        width: 100%;
        outline: none;
        font-size: 15px;
        padding: 5px 5px;
        resize: none;
      }
      .form-group button {
        height: 30px;
        width: 100px;
        font-weight: 700;
      }
      .form-container {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .grid-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
      }
      header {
        height: 100%;
        background-color: #d92b2c;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      }
      span {
        color: red;
      }
      .grid-1clm {
        display: grid;
        grid-template-columns: 1fr;
      }
      .grid-2clm {
        display: grid;
        grid-template-columns: 1fr 1fr;
      }
      footer {
        border: 1px solid #c0c0c0;
        padding: 15px;
        position: fixed;
        bottom: 0;
        width: 100%;
        background-color: #fff;
      }
      .slider-container {
        overflow: hidden;
        width: 100%; /* Adjust the width as needed */
        height: 100%; /* Adjust the height as needed */
        display: grid;
        align-items: center;
      }

      .slider {
        display: flex;
        width: 1300px; /* Total width of all slides (300px * 3 slides) */
        animation: slide 15s linear infinite; /* Adjust the animation duration */
      }

      .slide {
        flex: 0 0 0 250px; /* Set the width of individual slides */
        height: 100%; /* Set the height of individual slides */
        /* background-color: #3498db; Set the background color */
        margin-right: 10px; /* Adjust the margin between slides */
      }
      .slide img {
        width: 100%;
      }

      @keyframes slide {
        0% {
          transform: translateX(0);
        }
        33% {
          transform: translateX(-300px); /* Slide to the left */
        }
        66% {
          transform: translateX(-600px); /* Slide to the left */
        }
        100% {
          transform: translateX(0);
        }
      }

      .loader-container {
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #000000b5;
        position: fixed;
        width: 100%;
        height: 100vh;
        z-index: 10;
        top: 0;
      }

      .loader {
        border: 4px solid #3498db; /* Loader color */
        border-top: 4px solid transparent;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .alert {
        display: block;
        background-color: #4caf50;
        color: white;
        padding: 10px;
        margin-bottom: 20px;
        position: fixed;
        width: 100%;
        text-align: center;
        top: 0;
      }

      .alert-error {
        display: block;
        background-color: #4caf50;
        color: white;
        padding: 10px;
        margin-bottom: 20px;
        position: fixed;
        width: 100%;
        text-align: center;
        top: 0;
      }

      @media screen and (max-width: 768px) {
        /* CSS rules for mobile devices */
        .grid-container {
          display: flex;
          flex-direction: column-reverse;
        }
        .grid-2clm {
          display: block;
        }
        .grid-1clm {
          display: block;
        }
        .form-group input,
        select {
          width: 100%;
        }
        .form-container {
          display: block;
        }
        footer {
          position: inherit;
        }
        header {
          height: 100%;
        }
      }
    </style>
  </head>
  <body>
    <header></header>
    <div class="grid-container">
      <div class="form-container jsForm">
        <div style="margin-top: 25px">
          <div class="grid-2clm">
            <div class="form-group">
              <label for="">Fullname <span>*</span></label>
              <div>
                <input type="text" class="jsFullname" required />
              </div>
            </div>
            <div class="form-group">
              <label for="">Position <span>*</span></label>
              <div>
                <select class="jsPosition" required>
                  <option value="">--</option>
                  <option value="Owner">Owner</option>
                  <option value="Project Manager">Project Manager</option>
                  <option value="Project Engineer /PIC">
                    Project Engineer /PIC
                  </option>
                  <option value="QA/QS">QA/QS</option>
                  <option value="Purchasing">Purchasing</option>
                  <option value="Purchasing Manager">Purchasing Manager</option>
                  <option value="Architect">Architect</option>
                  <option value="Consultant">Consultant</option>
                  <option value="CFO">CFO</option>
                  <option value="Etc">Etc</option>
                </select>
                <input type="text" class="jsPostionInput" placeholder="Position name" style="margin-top: 5px; display: none;">
              </div>
            </div>
          </div>
          <div class="grid-2clm">
            <div class="form-group">
              <label for="">Company name <span>*</span></label>
              <div>
                <input type="text" class="jsCompany" required />
              </div>
            </div>
            <div class="form-group">
              <label for="">Classification of Company <span>*</span></label>
              <div>
                <select class="jsCompanyClassification" required>
                  <option value="">--</option>
                  <option value="Enduser">Enduser</option>
                  <option value="Hardware">Hardware</option>
                  <option value="Construction">Construction</option>
                  <option value="MEPF">MEPF</option>
                  <option value="Developer">Developer</option>
                  <option value="Designer">Designer</option>
                  <option value="Freelance">Freelance</option>
                  <option value="Trading">Trading</option>
                  <option value="Waterproofing Contractor">
                    Waterproofing Contractor
                  </option>
                  <option value="Facade Contractor">Facade Contractor</option>
                  <option value="Aluminum and Glass">Aluminum and Glass</option>
                  <option value="Motor Shop/Auto Shop">
                    Motor Shop/Auto Shop
                  </option>
                  <option value="Etc">Etc</option>

                </select>
                <input type="text" class="jsCompanyClassificationInput" placeholder="Classification name" style="margin-top: 5px; display: none;">
              </div>
            </div>
          </div>
          <div class="grid-2clm">
            <div class="form-group">
              <label for="">Contact number <span>*</span></label>
              <div>
                <input type="text" class="jsContactNumber" required />
              </div>
            </div>
            <div class="form-group">
              <label for="">Email <span>*</span></label>
              <div>
                <input type="text" class="jsEmail" required />
              </div>
            </div>
          </div>
          <div class="grid-1clm">
            <div class="form-group">
              <label for="">Product needed <span>*</span></label>
              <div>
                <textarea
                  name=""
                  rows="8"
                  class="jsProjectTarget"
                  required
                ></textarea>
              </div>
            </div>
          </div>

          <div class="form-group grid-2clm">
            <div>
              <button class="jsSubmitBtn">Submit</button>
            </div>
            <div
              style="display: flex; justify-content: end; align-items: flex-end"
            >
              <a
                href="img/MCSI PRODUCTS WITH PROJECTS_2023_0922_Vertical.pdf"
                download
                >Donwload Company Profile</a
              >
            </div>
          </div>
        </div>
      </div>
      <div
        class="form-container"
        style="border: 1px solid black; overflow: hidden"
      >
        <div class="slider-container">
          <div class="slider">
            <div class="slide">
              <img src="img/1.jpg" alt="" loading="lazy" />
            </div>
            <div class="slide">
              <img src="img/2.jpg" alt="" loading="lazy" />
            </div>
            <div class="slide">
              <img src="img/3.jpg" alt="" loading="lazy" />
            </div>
            <div class="slide">
              <img src="img/4.jpg" alt="" loading="lazy" />
            </div>
            <div class="slide">
              <img src="img/5.jpg" alt="" loading="lazy" />
            </div>
            <div class="slide">
              <img src="img/6.jpg" alt="" loading="lazy" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer>
      <p>&copy; MCSI - <label id="currentYear"></label></p>
    </footer>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-analytics.js";
      import {
        getDatabase,
        ref,
        push,
      } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-database.js"; // Add this line

      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyA1H653oOp7EvydcQ2lZLhS1qRuHDlgpcY",
        authDomain: "mcsiform.firebaseapp.com",
        databaseURL: "https://mcsiform-default-rtdb.firebaseio.com",
        projectId: "mcsiform",
        storageBucket: "mcsiform.appspot.com",
        messagingSenderId: "182194495593",
        appId: "1:182194495593:web:f660b263fdd36192ff02f8",
        measurementId: "G-PS9DH5L494",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);

      // Get a reference to the database
      const database = getDatabase(app);

      document.querySelector(".jsSubmitBtn").addEventListener("click", () => {
        if (validateForm(document.querySelector(".jsForm"))) {
          const currentDate = new Date();

          const year = currentDate.getFullYear();
          const month = currentDate.getMonth() + 1; // Note: Months are zero-based, so we add 1 to get the correct month.
          const day = currentDate.getDate();
          const today = `${year}-${month}-${day}`;

          // Reference to a specific location in the database
          const dataRef = ref(database, today); // Replace 'your-data-path' with the actual path in your database

          const fullname = document.querySelector(".jsFullname");
          const position = document.querySelector(".jsPosition");
          const companyName = document.querySelector(".jsCompany");
          const companyClassification = document.querySelector(".jsCompanyClassification");
          const contactNumber = document.querySelector(".jsContactNumber");
          const email = document.querySelector(".jsEmail");
          const projectTarget = document.querySelector(".jsProjectTarget");
          const positionInput = document.querySelector('.jsPostionInput');
          const companyNameInput = document.querySelector('.jsCompanyClassificationInput');
          
          let positionValue = null;
          let companyClassValue = null;

          if(position.value == "Etc"){
            positionValue = positionInput.value
          }else{
            positionValue = position.value;
          }

          if(companyClassification.value == "Etc"){
            companyClassValue = companyNameInput.value;
          }else{
            companyClassValue = companyClassification.value;
          }

          // Data to be saved
          const newData = {
            _1Fullname: fullname.value,
            _2Position: positionValue,
            _3CompanyName: companyName.value,
            _4ClassificationOfCompany: companyClassValue,
            _5ContactNumber: contactNumber.value,
            _5Email: email.value,
            _6ProjectTarget: projectTarget.value,
          };

          let view = `<div class="loader-container">
                        <div class="loader"></div>
                    </div>`;
          let domparse = new DOMParser()
            .parseFromString(view, "text/html")
            .querySelector(".loader-container");
          document.body.append(domparse);

          // Push the data to the database
          push(dataRef, newData)
            .then(() => {
              console.log("Data saved successfully.");
              document.querySelector(".loader-container").remove();

              let alert = `<div class="alert" id="alert">Message Sent!</div>`;
              let domparseAlert = new DOMParser()
                .parseFromString(alert, "text/html")
                .querySelector("#alert");
              document.body.append(domparseAlert);

              setTimeout(() => {
                document.querySelector("#alert").remove();
              }, 3000);

              setTimeout(() => {
                location.reload();
              }, 3000);
            })
            .catch((error) => {
              let alert = `<div class="alert-error" id="alert"></div>`;
              let domparseAlert = new DOMParser()
                .parseFromString(alert, "text/html")
                .querySelector("#alert");
              domparseAlert.querySelector("#alert").textContent = error;
              document.body.append(domparseAlert);
              console.error("Error saving data: ", error);

              setTimeout(() => {
                document.querySelector(".loader-container").remove();
              }, 3000);

              setTimeout(() => {
                location.reload();
              }, 3000);
            });
        }
      });

      function validateForm(parentEl) {
        let errors = 0;

        parentEl
          .querySelectorAll(
            "input[required],select[required],textarea[required]"
          )
          .forEach((item) => {
            if (item.value) {
              item.removeAttribute("style");
            } else {
              errors += 1;

              item.setAttribute("style", "border: 1px solid red");
            }
          });

        return errors == 0 ? true : false;
      }
    </script>

    <script>
      const currentYear = new Date().getFullYear();
      document.getElementById("currentYear").textContent = currentYear;

      const position = document.querySelector(".jsPosition");
      const companyName = document.querySelector(".jsCompanyClassification");
      const positionInput = document.querySelector('.jsPostionInput');
      const companyNameInput = document.querySelector('.jsCompanyClassificationInput');

      position.addEventListener('change', () =>{
        if(position.value == "Etc"){
          console.log('show input')
          positionInput.style= "margin-top: 5px; display: block;";
        }else{
           positionInput.style= "margin-top: 5px; display: none;";
        }

      })

      companyName.addEventListener('change', () =>{
        if(companyName.value == "Etc"){
          console.log('show input')
          companyNameInput.style= "margin-top: 5px; display: block;";
        }else{
           companyNameInput.style= "margin-top: 5px; display: none;";
        }

      })

      let parentEl = document.querySelector("header");
      const mediaQuery = window.matchMedia("(max-width: 768px)");

      handleMediaQueryChange(mediaQuery);

      mediaQuery.addListener(handleMediaQueryChange);
      function handleMediaQueryChange(event) {
        if (event.matches) {
          console.log("Media query matches: viewport is less than 768px");
          parentEl.innerHTML = `<img src="img/mcsi.jpg" alt="" style="height: 100%; width: 100%" loading="lazy"/>`;
        } else {
          parentEl.innerHTML = `<img src="img/MSCI_header.jpg" alt="" style="height: 100%; width: 100%" loading="lazy"/>`;
        }
      }
    </script>
  </body>
</html>
